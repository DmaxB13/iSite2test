<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Minecraft 3-D Mannequins (Test)</title>
<style>
body{background:#0b1120;color:#fff;font-family:system-ui,Arial;padding:20px;text-align:center}
textarea{width:100%;max-width:600px;height:60px;border-radius:8px;padding:8px;margin:10px 0;font-size:1rem}
button{background:#4dabf7;color:#021018;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:bold}
.gallery{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;margin-top:20px}
.viewer{width:200px;height:300px;background:#111a2e;border-radius:10px;box-shadow:0 0 12px rgba(0,0,0,0.6)}
</style>
<!-- load renderer first -->
<script src="https://unpkg.com/skinview3d@3.0.0-beta.2/bundles/skinview3d.bundle.js"></script>
</head>
<body>
<h1>Minecraft 3-D Mannequins (Test)</h1>
<p>Enter usernames or UUIDs, comma separated:</p>
<textarea id="names">Notch, Dinnerbone</textarea><br>
<button id="loadBtn">Load & Render</button>
<div id="status">Ready</div>
<div id="gallery" class="gallery"></div>

<script>
const PLAYERDB = "https://playerdb.co/api/player/minecraft/";
const CRAFATAR = uuid => `https://crafatar.com/skins/${uuid}`;

const btn = document.getElementById("loadBtn");
const input = document.getElementById("names");
const gallery = document.getElementById("gallery");
const statusEl = document.getElementById("status");

function logStatus(msg){statusEl.textContent=msg;}

function isUUID(s){return /^[0-9a-fA-F-]{32,36}$/.test(s);}
async function getUUID(name){
  if(isUUID(name)) return name.replace(/-/g,"");
  const res = await fetch(PLAYERDB+encodeURIComponent(name));
  const data = await res.json();
  if(!data?.data?.player?.id) throw new Error("No player: "+name);
  return data.data.player.id;
}

function renderViewer(uuid,name){
  const wrap=document.createElement("div");
  wrap.className="viewer";
  gallery.appendChild(wrap);
  const canvas=document.createElement("canvas");
  wrap.appendChild(canvas);
  const viewer=new skinview3d.SkinViewer({
    canvas,
    width:200,
    height:300
  });
  viewer.loadSkin(CRAFATAR(uuid));
  viewer.controls.enableZoom=false;
  viewer.zoom=0.8;
  viewer.autoRotate=true;
  viewer.autoRotateSpeed=0.4;
  const label=document.createElement("div");
  label.textContent=name;
  label.style.marginTop="6px";
  gallery.appendChild(label);
}

btn.addEventListener("click",async()=>{
  gallery.innerHTML="";
  const names=input.value.split(",").map(s=>s.trim()).filter(Boolean);
  if(names.length===0){logStatus("Enter a name first");return;}
  logStatus("Loading...");
  for(const n of names){
    try{
      const uuid=await getUUID(n);
      renderViewer(uuid,n);
    }catch(e){
      console.error(e);
      const err=document.createElement("div");
      err.textContent="Error loading "+n;
      gallery.appendChild(err);
    }
  }
  logStatus("Done!");
});
</script>
</body>
</html>
